jQuery(document).ready(function(a){var b={init:function(){window.nooImgUploadCount=a("#uploaded-images .uploaded-img").length;this.maxFiles=parseInt(noo_img_upload.max_files);a("#uploaded-images").on("click","a.remove-img",this.removeUploads);a("#uploaded-images").on("click","img",this.setFeatured);this.attach();this.hideUploader()},attach:function(){if(typeof(plupload)==="undefined"){return}var c=new plupload.Uploader(noo_img_upload.plupload);a("#aaiu-uploader").click(function(d){c.start();d.preventDefault()});c.init();c.bind("FilesAdded",function(d,e){a.each(e,function(f,g){a("#aaiu-upload-imagelist").append('<div id="'+g.id+'">'+g.name+" ("+plupload.formatSize(g.size)+") <b></b></div>")});d.refresh();c.start()});c.bind("UploadProgress",function(d,e){a("#"+e.id+" b").html(e.percent+"%")});c.bind("Error",function(d,e){a("#aaiu-upload-imagelist").append("<div>Error: "+e.code+", Message: "+e.message+(e.file?", File: "+e.file.name:"")+"</div>");d.refresh()});c.bind("FileUploaded",function(i,e,f){var g=a.parseJSON(f.response);a("#"+e.id).remove();if(g.success){window.nooImgUploadCount+=1;if(a("#gallery").length>0){var d=a("#gallery").val();d=(d==="")?g.image_id:d+","+g.image_id;a("#gallery").val(d);a("#uploaded-images").append('<div class="uploaded-img" data-imageid="'+g.image_id+'"><img src="'+g.thumbnail+'" /><a href="javascript:void(0)" class="remove-img"><i class="remove-img fa fa-trash-o"></i></a></div>');if(a("#uploaded-images .featured-img").length===0){var h=a("#uploaded-images .uploaded-img:first-child");h.append('<i class="featured-img fa fa-star"></i>');a("input#featured_img").val(h.attr("data-imageid"))}}if(a("#avatar").length>0){a("#avatar").val(g.image_id);a("#uploaded-images").empty().append('<div class="uploaded-img" data-imageid="'+g.image_id+'"><img src="'+g.thumbnail+'" /></div>');a(".user-sidebar-menu .user-avatar > img").attr("src",g.image)}b.hideUploader()}})},hideUploader:function(){if(b.maxFiles!==0&&window.nooImgUploadCount>=b.maxFiles){a("#aaiu-uploader").hide()}},removeUploads:function(c){c.preventDefault();if(confirm(noo_img_upload.confirmMsg)){var d=a(this),f={attach_id:d.parent().attr("data-imageid"),nonce:noo_img_upload.remove,action:"noo_delete_file"};a.post(noo_img_upload.ajaxurl,f,function(e){d.parent().remove();window.nooImgUploadCount-=1;if(b.maxFiles!==0&&window.nooImgUploadCount<b.maxFiles){a("#aaiu-uploader").show()}})}},setFeatured:function(){a("#uploaded-images .featured-img").each(function(){a(this).remove()});a(this).parent().append('<i class="featured-img fa fa-star"></i>');a("input#featured_img").val(a(this).parent().attr("data-imageid"))},};b.init()});